from cvereporter import fetch_vulnerabilities
from cvereporter import report
from cvereporter import nist_enhance
"""
this was the first cut downloader to retrieve vulnerabilities and create a vdr based off of a single report (on a given date) from OJVG
"""
bom = report.get_base_bom()
#todo: take date as arg or figure out other way to seed 
vulns = fetch_vulnerabilities.fetch_cves('2023-01-17')
#todo: decorate vulnerabilities with info from NIST and others here
nist_enhance.enhance(vulns)
for vuln in vulns:
    bom.vulnerabilities.add(vuln)
print(report.serialize_to_json(bom))